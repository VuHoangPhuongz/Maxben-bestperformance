<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chi Ti·∫øt D·ª± √Ån - MAXBEN</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Be Vietnam Pro', sans-serif; background-color: #020617; color: #e2e8f0; }
        .gradient-text { background: linear-gradient(90deg, #38bdf8, #a78bfa); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .sticky-nav { position: sticky; top: 0; z-index: 50; background-color: rgba(15, 23, 42, 0.8); backdrop-filter: blur(10px); }
        .prose-custom { color: #cbd5e1; }
        .prose-custom h3 { color: #ffffff; font-weight: 700; font-size: 1.25rem; margin-top: 1.5rem; margin-bottom: 0.75rem; border-left: 3px solid #38bdf8; padding-left: 1rem;}
        .prose-custom p { margin-bottom: 1em; line-height: 1.7; }
        .prose-custom ul { list-style-position: outside; margin-left: 1rem; }
        .prose-custom li { padding-left: 0.5rem; margin-bottom: 0.5rem; }
        .prose-custom li::marker { color: #38bdf8; }
        .gallery-thumbnail.active { border-color: #38bdf8; box-shadow: 0 0 15px rgba(56, 189, 248, 0.5); }
        .testimonial-card {
            background-color: #1e293b;
            border-left: 4px solid #2563eb;
        }
        #product-dropdown-menu a {
    display: block;
    padding: 0.6rem 1rem;
    border-radius: 0.375rem;
    color: #d1d5db;
    font-size: 0.875rem;
    white-space: nowrap;
    transition: background-color 0.2s, color 0.2s;
}
#product-dropdown-menu a:hover {
    background-color: #2563EB;
    color: #ffffff;
}
.modal-specs-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 1rem;
}

.modal-specs-table td {
    padding: 0.75rem 0.5rem;
    border-bottom: 1px solid #334155; /* Tailwind slate-700 */
    text-align: left;
}

.modal-specs-table td:first-child {
    font-weight: 500; /* medium font weight */
    color: #cbd5e1; /* Tailwind slate-300 */
    width: 30%; /* Give some width to the label column */
}

.modal-specs-table td:last-child {
    color: #e2e8f0; /* Tailwind slate-200 */
}
    #modal-tab-content #description-content ul {
        list-style-type: disc; /* ƒê·∫£m b·∫£o ki·ªÉu g·∫°ch ƒë·∫ßu d√≤ng l√† ƒëƒ©a (bullet point truy·ªÅn th·ªëng) */
        margin-left: 1.5rem;   /* Th·ª•t v√†o ƒë·ªÉ c√≥ kh√¥ng gian cho g·∫°ch ƒë·∫ßu d√≤ng */
        padding-left: 0;       /* ƒê·∫£m b·∫£o kh√¥ng c√≥ padding th·ª´a */
    }

    #modal-tab-content #description-content ul li {
        margin-bottom: 0.5rem; /* Kho·∫£ng c√°ch gi·ªØa c√°c m·ª•c trong danh s√°ch, gi√∫p d·ªÖ ƒë·ªçc h∆°n */
        padding-left: 0.5rem;  /* M·ªôt ch√∫t padding cho text */
        line-height: 1.6;      /* TƒÉng line-height ƒë·ªÉ c√°c d√≤ng text kh√¥ng qu√° s√°t nhau */
        color: #e2e8f0;        /* ƒê·∫£m b·∫£o m√†u ch·ªØ d·ªÖ ƒë·ªçc tr√™n n·ªÅn t·ªëi */
    }

    /* ƒê·ªïi m√†u c·ªßa g·∫°ch ƒë·∫ßu d√≤ng (bullet point) */
    #modal-tab-content #description-content ul li::marker {
        color: #38bdf8; /* M√†u xanh s√°ng c·ªßa Tailwind's sky-400 ho·∫∑c blue-400, gi·ªëng h√¨nh ·∫£nh */
    }
    /* C√†i ƒë·∫∑t chung */
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f0f2f5;
    color: #333;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
}

.page-content {
    flex: 1;
    padding: 2rem;
    text-align: center;
}

/* Bi·∫øn m√†u s·∫Øc ƒë·ªÉ d·ªÖ d√†ng t√πy ch·ªânh */
:root {
    --footer-bg-color: #1f2937; /* M√†u n·ªÅn ch√≠nh c·ªßa footer (x√°m ƒëen) */
    --footer-text-color: #d1d5db; /* M√†u ch·ªØ ph·ª• (x√°m nh·∫°t) */
    --footer-heading-color: #ffffff; /* M√†u ti√™u ƒë·ªÅ */
    --footer-primary-color: #ef4444; /* M√†u nh·∫•n (ƒë·ªè) */
    --footer-hover-color: #ffffff; /* M√†u khi di chu·ªôt qua link */
}

/* ================== B·∫ÆT ƒê·∫¶U CSS CHO FOOTER ================== */

.site-footer {
    background-color: var(--footer-bg-color);
    color: var(--footer-text-color);
    padding: 60px 0;
    font-size: 15px;
}

.footer-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
}

/* Layout l∆∞·ªõi ch√≠nh */
.footer-grid {
    display: grid;
    gap: 40px;
    grid-template-columns: repeat(1, 1fr); /* M·∫∑c ƒë·ªãnh 1 c·ªôt tr√™n mobile */
}

/* C·ªôt 1: Logo & m√¥ t·∫£ */
.footer-logo {
    font-size: 28px;
    font-weight: bold;
    color: var(--footer-primary-color);
    margin: 0 0 10px 0;
}
.footer-description {
    margin: 0;
    line-height: 1.6;
}

/* Ti√™u ƒë·ªÅ chung cho c√°c c·ªôt */
.footer-heading {
    font-size: 16px;
    font-weight: bold;
    color: var(--footer-heading-color);
    margin-top: 0;
    margin-bottom: 20px;
    text-transform: uppercase;
}

/* C·ªôt 2 & 3: Danh s√°ch link v√† li√™n h·ªá */
.footer-links, .contact-info {
    list-style: none;
    padding: 0;
    margin: 0;
}
.footer-links li, .contact-info li {
    margin-bottom: 12px;
}
.footer-links a, .contact-info a {
    color: var(--footer-text-color);
    text-decoration: none;
    transition: color 0.3s ease;
}
.footer-links a:hover, .contact-info a:hover {
    color: var(--footer-hover-color);
}

.contact-info li {
    display: flex;
    align-items: flex-start;
}
.contact-info i {
    color: var(--footer-primary-color);
    margin-right: 12px;
    margin-top: 4px;
    width: 16px;
}

/* C·ªôt 4: ƒêƒÉng k√Ω nh·∫≠n tin */
.newsletter-description {
    margin: 0 0 1rem 0;
}
.newsletter-form {
    display: flex;
    margin-bottom: 1.5rem;
}
.newsletter-input {
    width: 100%;
    padding: 10px 12px;
    background-color: #ffffff;
    color: #111827;
    border: 1px solid #d1d5db;
    border-radius: 6px 0 0 6px;
    outline: none;
}
.newsletter-button {
    padding: 10px 16px;
    color: #ffffff;
    background-color: var(--footer-primary-color);
    border: none;
    border-radius: 0 6px 6px 0;
    cursor: pointer;
    transition: background-color 0.3s ease;
}
.newsletter-button:hover {
    background-color: #dc2626;
}

/* C·ªôt 4: Icon M·∫°ng x√£ h·ªôi */
.social-icons {
    display: flex;
    gap: 12px;
}
.social-icons a {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background-color: #4b5563; /* N·ªÅn icon x√°m ƒë·∫≠m h∆°n */
    color: #ffffff;
    border-radius: 50%;
    text-decoration: none;
    transition: all 0.3s ease;
}
.social-icons a:hover {
    background-color: var(--footer-primary-color);
    transform: translateY(-3px);
}

/* D√≤ng Copyright ·ªü cu·ªëi */
.footer-bottom {
    text-align: center;
    margin-top: 50px;
    padding-top: 20px;
    border-top: 1px solid #4b5563;
    font-size: 14px;
}

/* ================== RESPONSIVE ================== */

/* Tr√™n Tablet */
@media (min-width: 768px) {
    .footer-grid {
        grid-template-columns: repeat(2, 1fr); /* 2 c·ªôt */
    }
}

/* Tr√™n Desktop */
@media (min-width: 1024px) {
    .footer-grid {
        grid-template-columns: repeat(4, 1fr); /* 4 c·ªôt */
    }
}
    </style>
</head>
<body class="bg-slate-950">

    <header class="sticky-nav border-b border-gray-700">
        <div class="container mx-auto px-4">
            <nav class="flex items-center justify-between h-20">
                <a href="index.html" class="text-3xl font-bold text-red-500">MAXBENüí°</a>
                <div class="hidden md:flex items-center space-x-6 lg:space-x-8">
                    <a href="index.html" class="text-gray-300 hover:text-white transition-colors">Trang Ch·ªß</a>
                    <a href="du-an.html" class="text-gray-300 hover:text-white transition-colors">D·ª± √Ån & T∆∞ V·∫•n</a>
<div class="relative group">
    <a href="san-pham.html" class="text-gray-300 hover:text-white transition-colors flex items-center py-2">
        S·∫£n Ph·∫©m
        <i class="fas fa-chevron-down text-xs ml-2 transition-transform duration-300 group-hover:rotate-180"></i>
    </a>
    <div id="product-dropdown-menu" class="absolute top-full left-1/2 -translate-x-1/2 mt-3 w-60 bg-slate-800 border border-slate-700 rounded-lg shadow-lg p-2 z-50
        opacity-0 invisible group-hover:opacity-100 group-hover:visible transform -translate-y-2 group-hover:translate-y-0
        transition-all duration-300 ease-in-out">
        <div class="text-center py-4">
            <i class="fas fa-spinner fa-spin text-white"></i>
        </div>
    </div>
</div>
                    <a href="du-lieu.html" class="text-gray-300 hover:text-white transition-colors">D·ªØ li·ªáu kh√°ch h√†ng</a>
                    <a href="TCO.html" class="text-gray-300 hover:text-white transition-colors">C√¥ng c·ª• t√≠nh TCO</a>
                </div>
                <div class="flex items-center">
                     <a href="tel:0886666730" class="cta-button bg-blue-600 text-white font-semibold py-2 px-5 rounded-lg shadow-lg hidden md:block">
                       üìû G·ªçi Ngay
                    </a>
                    <div class="md:hidden ml-4">
                        <button id="mobile-menu-button" class="text-gray-300 hover:text-white focus:outline-none">
                            <i class="fas fa-bars fa-lg"></i>
                        </button>
                    </div>
                </div>
            </nav>
        </div>
        <!-- Mobile Menu -->
<div id="mobile-menu" class="hidden md:hidden px-4 pb-4">
    <a href="index.html" class="block py-2 text-gray-300 hover:text-white">Trang Ch·ªß</a>
      <a href="ve-chung-toi.html" class="text-gray-300 hover:text-white">V·ªÅ Ch√∫ng T√¥i</a>
    <div class="relative group">
        <a href="san-pham.html" class="block py-2 text-gray-300 hover:text-white flex items-center justify-between">
            S·∫£n Ph·∫©m
            <i class="fas fa-chevron-down text-xs ml-2 transition-transform duration-300"></i>
        </a>
        <div id="mobile-product-categories-list" class="pl-4 border-l border-gray-700 mt-2 space-y-1">
            </div>
    </div>
    <a href="du-an.html" class="block py-2 text-gray-300 hover:text-white">D·ª± √Ån & T∆∞ V·∫•n</a>
    <a href="ve-chung-toi.html" class="text-gray-300 hover:text-white">V·ªÅ Ch√∫ng T√¥i</a>
    <a href="du-lieu.html" class="block py-2 text-gray-300 hover:text-white">D·ªØ li·ªáu kh√°ch h√†ng</a>
    <a href="TCO.html" class="block py-2 text-gray-300 hover:text-white">C√¥ng c·ª• t√≠nh TCO</a>
    <a href="tel:0886666730" class="block py-2 text-gray-300 hover:text-white">üìû Li√™n H·ªá </a>
</div>
    </header>
<main id="project-detail-content" class="py-12 md:py-16">
    <!-- N·ªôi dung chi ti·∫øt d·ª± √°n s·∫Ω ƒë∆∞·ª£c JS ch√®n v√†o ƒë√¢y -->
    <div class="container mx-auto px-6 text-center py-20">
        <div class="text-4xl text-amber-400 mb-4">
            <i class="fas fa-spinner fa-spin"></i>
        </div>
        <h1 class="text-2xl text-white">ƒêang t·∫£i th√¥ng tin d·ª± √°n...</h1>
    </div>
</main>
<div id="product-modal" class="fixed inset-0 z-[100] flex items-center justify-center p-4 hidden">
    <div id="modal-overlay" class="modal-overlay absolute inset-0 bg-black/70 opacity-0"></div>
    
    <div id="modal-container" class="modal-container relative w-full max-w-4xl max-h-[90vh] bg-slate-800 rounded-2xl shadow-2xl flex flex-col opacity-0 transform scale-95">
        <div class="flex-shrink-0 p-4 flex items-center justify-between border-b border-slate-700">
            <h2 class="text-lg font-bold text-white" id="modal-product-title">Chi ti·∫øt s·∫£n ph·∫©m</h2>
            <button id="modal-close-btn" class="text-gray-400 hover:text-white text-2xl">√ó</button>
        </div>
        
        <div id="modal-content-area" class="modal-content-area p-6 overflow-y-auto">
            </div>
    </div>
</div>
        <footer class="site-footer">
        <div class="footer-container">
            <div class="footer-grid">
                
                <div class="footer-column">
                    <h3 class="footer-logo">MAXBENüí°</h3>
                    <p class="footer-description">
                        Ki·∫øn t·∫°o kh√¥ng gian b·∫±ng √°nh s√°ng ch·∫•t l∆∞·ª£ng v√† gi·∫£i ph√°p chuy√™n nghi·ªáp.
                    </p>
                </div>

                <div class="footer-column">
                    <h4 class="footer-heading">Li√™n K·∫øt Nhanh</h4>
                    <ul class="footer-links">
                        <li><a href="san-pham.html">S·∫£n Ph·∫©m</a></li>
                        <li><a href="du-an.html">D·ª± √Ån Ti√™u Bi·ªÉu</a></li>
                        <li><a href="ve-chung-toi.html">V·ªÅ Ch√∫ng T√¥i</a></li>
                        <li><a href="du-an.html#tuvan">T∆∞ V·∫•n</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h4 class="footer-heading">Th√¥ng Tin Li√™n H·ªá</h4>
                    <ul class="contact-info">
                        <li>
                            <i class="fas fa-map-marker-alt"></i>
                            <span>524 Minh Khai, Hai B√† Ch∆∞ng, Tp.H√† N·ªôi</span>
                        </li>
                        <li>
                            <i class="fas fa-phone-alt"></i>
                            <a href="tel:0886666730">0886666730</a>
                        </li>
                        <li>
                            <i class="fas fa-envelope"></i>
                            <a href="mailto:info@maxben.com">info@maxben.com</a>
                        </li>
                    </ul>
                </div>

                <div class="footer-column">
                    <h4 class="footer-heading">ƒêƒÉng K√Ω Nh·∫≠n Tin</h4>
                    <p class="newsletter-description">Nh·∫≠n th√¥ng tin m·ªõi nh·∫•t v·ªÅ s·∫£n ph·∫©m v√† khuy·∫øn m√£i.</p>
                   <form action="https://formspree.io/f/xovwpjdn" method="POST" class="newsletter-form" > <label for="email"></label> <input id="email" type="email" name="email" placeholder="Nh·∫≠p email c·ªßa b·∫°n" class="newsletter-input" required > <button type="submit" class="newsletter-button">G·ª≠i</button> </form>
                    <div class="social-icons">
                        <a href="https://www.facebook.com/maxbenled" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://www.youtube.com/@denledmaxben" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>

            </div>

            <div class="footer-bottom">
                <p>¬© 2025 MAXBEN. All Rights Reserved.</p>
            </div>
        </div>
    </footer>



<script>
// File: du-an-chi-tiet.js (Specific logic for Project Detail Page)

document.addEventListener('DOMContentLoaded', () => {
    // --- DOM ELEMENTS (Modal elements are common, but declared here for this file's scope) ---
    const productModal = document.getElementById('product-modal');
    const modalOverlay = document.getElementById('modal-overlay');
    const modalContainer = document.getElementById('modal-container');
    const modalContentArea = document.getElementById('modal-content-area');
    const modalCloseBtn = document.getElementById('modal-close-btn');
    const modalProductTitle = document.getElementById('modal-product-title');

    const projectDetailContentContainer = document.getElementById('project-detail-content');

    // --- DATA PREPARATION ---
    // Make sure allProducts and allProjects are loaded globally from product-details.js and project-data.js
    if (typeof allProducts === 'undefined' || Object.keys(allProducts).length === 0) {
        console.error("L·ªói: D·ªØ li·ªáu `allProducts` kh√¥ng t·ªìn t·∫°i ho·∫∑c r·ªóng. ƒê·∫£m b·∫£o product-details.js ƒë∆∞·ª£c n·∫°p.");
        if (projectDetailContentContainer) {
            projectDetailContentContainer.innerHTML = `<div class="container mx-auto px-6 text-center py-20"><h1 class="text-3xl text-red-500 font-bold">L·ªói t·∫£i d·ªØ li·ªáu s·∫£n ph·∫©m.</h1></div>`;
        }
        return; // D·ª´ng n·∫øu thi·∫øu d·ªØ li·ªáu s·∫£n ph·∫©m v√¨ modal ph·ª• thu·ªôc v√†o n√≥
    }
    const allProductsArray = Object.values(allProducts);

    if (typeof allProjects === 'undefined' || allProjects.length === 0) {
        console.error("L·ªói: D·ªØ li·ªáu `allProjects` kh√¥ng t·ªìn t·∫°i ho·∫∑c r·ªóng. ƒê·∫£m b·∫£o project-data.js ƒë∆∞·ª£c n·∫°p.");
        if (projectDetailContentContainer) {
            projectDetailContentContainer.innerHTML = `<div class="container mx-auto px-6 text-center py-20"><h1 class="text-3xl text-red-500 font-bold">L·ªói t·∫£i d·ªØ li·ªáu d·ª± √°n.</h1></div>`;
        }
        return; // D·ª´ng n·∫øu thi·∫øu d·ªØ li·ªáu d·ª± √°n cho trang n√†y
    }

    // --- HELPER FUNCTIONS ---
    const parsePrice = (str) => !str || typeof str !== 'string' ? 0 : parseInt(str.replace(/\D/g, ''), 10) || 0;

    // ==========================================================
    // === MODAL LOGIC (Copied from main-app.js / index-logic.js for this specific file) ===
    // ==========================================================
    // This function will be callable globally if this script is loaded.
    window.openProductModal = function(productId) { // Expose to global scope for product-used-card click
        const product = allProducts[productId];
        if (!product) {
            console.error("Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m v·ªõi ID:", productId);
            return;
        }

        const productVariants = allProductsArray.filter(p => p.name === product.name);
        const relatedProducts = allProductsArray.filter(p => p.category === product.category && p.name !== product.name)
            .filter((p, i, self) => i === self.findIndex(t => t.name === p.name))
            .slice(0, 4);

        modalProductTitle.textContent = product.displayName;
        modalContentArea.innerHTML = `
            <div class="grid lg:grid-cols-5 gap-8">
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-lg p-2 mb-3"><img id="modalMainImage" src="${product.image}" alt="${product.displayName}" class="w-full h-auto object-contain rounded-md"></div>
                    <div id="modalThumbnailGallery" class="grid grid-cols-4 gap-2">${(product.gallery || [product.image]).map((img, i) => `<img src="${img}" class="thumbnail w-full aspect-square object-cover cursor-pointer rounded-md border-2 bg-slate-700 ${i === 0 ? 'active' : 'border-transparent'}">`).join('')}</div>
                </div>
                <div class="lg:col-span-3">
                    <h1 class="text-2xl font-bold text-white">${product.displayName}</h1>
                    <p class="text-xs text-gray-400 mt-1 mb-3">M√£ SP: ${product['M√£ Qu·∫£n L√Ω'] || 'N/A'}</p>
                    <p class="text-3xl font-bold text-amber-400 mb-4">${product.price || "Li√™n h·ªá"}</p>

                    <div id="variant-selector" class="mb-4">
                        <p class="font-semibold text-gray-300 mb-2">Ch·ªçn phi√™n b·∫£n:</p>
                        <div class="flex flex-wrap gap-2">
                            ${productVariants.map(v => `<button class="variant-btn px-4 py-2 rounded-lg border border-slate-600 bg-slate-700 text-gray-300 hover:bg-blue-600 hover:border-blue-600 hover:text-white transition-all duration-200 text-sm" data-id="${v.id}">${v.power} (${v.light})</button>`).join('')}
                        </div>
                    </div>

                    <div class="mt-4 pt-4 border-t border-slate-700">
                        <label class="block text-sm font-semibold text-gray-300 mb-2">T√≠nh gi√° chi·∫øt kh·∫•u cho ƒë·∫°i l√Ω:</label>
                        <div class="flex items-center space-x-2">
                            <input type="number" id="discount-percentage-input" placeholder="Nh·∫≠p %" class="flex-grow text-sm py-2 px-3 rounded-md bg-slate-700 border border-slate-600 text-white placeholder-gray-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500" />
                            <button id="calculate-discount-btn" class="bg-green-600 text-white font-semibold py-2 px-4 rounded-md hover:bg-green-700 text-sm">T√≠nh Gi√°</button>
                        </div>
                        <div id="discounted-price-display" class="mt-2 text-md hidden bg-green-500/10 border border-green-500/30 rounded-md p-2 text-center"></div>
                    </div>

                    <div class="flex items-center space-x-4 border-t border-slate-700 py-3 my-4 text-xs">
                        <span class="flex items-center"><i class="fas fa-check-circle mr-2 text-green-500"></i>H√†ng ch√≠nh h√£ng</span>
                        <span class="flex items-center"><i class="fas fa-shield-alt mr-2 text-blue-500"></i>B·∫£o h√†nh 2-3 nƒÉm</span>
                        <span class="flex items-center"><i class="fas fa-medal mr-2 text-yellow-500"></i>Ch·∫•t l∆∞·ª£ng cao</span>
                    </div>

                    <div class="flex flex-col sm:flex-row gap-3">
                        <a href="tel:0886666730" class="w-full text-center bg-blue-600 text-white font-bold py-3 px-5 rounded-lg hover:bg-blue-700"><i class="fas fa-phone-alt mr-2"></i> T∆∞ V·∫•n Ngay</a>
                        <a href="https://zalo.me/0886666730" target="_blank" class="w-full text-center bg-slate-600 text-white font-bold py-3 px-5 rounded-lg">Y√™u C·∫ßu B√°o Gi√°</a>
                    </div>
                </div>
            </div>

            <div class="mt-8 pt-6 border-t border-slate-700">
                <div class="border-b border-slate-700 mb-4">
                    <nav id="modal-tab-buttons" class="flex space-x-6">
                        <button data-tab="description" class="modal-tab-btn px-4 py-2 text-sm font-semibold text-gray-300 border-b-2 border-transparent hover:border-blue-500 hover:text-white transition-all duration-200 active">M√¥ t·∫£ chi ti·∫øt</button>
                        <button data-tab="specs" class="modal-tab-btn px-4 py-2 text-sm font-semibold text-gray-300 border-b-2 border-transparent hover:border-blue-500 hover:text-white transition-all duration-200">Th√¥ng s·ªë k·ªπ thu·∫≠t</button>
                    </nav>
                </div>
                <div id="modal-tab-content">
                    <div id="description-content" class="text-gray-300 space-y-1 text-sm leading-relaxed prose max-w-none">
                        <ul>${(product.features || '').split('.').filter(s => s.trim() !== '').map(s => `<li>${s.trim()}.</li>`).join('')}</ul>
                    </div>
                    <div id="specs-content" class="hidden text-sm">
                        <table class="modal-specs-table"><tbody>
                            <tr><td>C√¥ng su·∫•t</td><td>${product.power || 'N/A'}</td></tr>
                            <tr><td>Quang th√¥ng</td><td>${product.lumen || 'N/A'}</td></tr>
                            <tr><td>Nhi·ªát ƒë·ªô m√†u</td><td>${product.light || 'N/A'}</td></tr>
                            <tr><td>K√≠ch th∆∞·ªõc</td><td>${product.dimensions_mm || product.k√≠ch_th∆∞·ªõc || 'N/A'}</td></tr>
                            <tr><td>L·ªó kho√©t</td><td>${product.cutout_mm || product.c·∫Øt_l·ªó || 'N/A'}</td></tr>
                            <tr><td>ƒêi·ªán √°p</td><td>${product['ƒêi·ªán √°p'] || 'N/A'}</td></tr>
                        </tbody></table>
                    </div>
                </div>
            </div>

            <div id="related-products-section" class="mt-8 pt-6 border-t border-slate-700">
                <h3 class="text-xl font-bold text-white mb-4">S·∫£n ph·∫©m t∆∞∆°ng t·ª±</h3>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    ${relatedProducts.map(rel => `
                        <div class="product-showcase-card group cursor-pointer bg-slate-800 rounded-lg overflow-hidden border border-slate-700 hover:border-blue-500 transition-all duration-300 flex flex-col" data-id="${rel.id}">
                            <div class="product-showcase-image-wrapper relative w-full pt-[100%] overflow-hidden bg-white flex items-center justify-center p-2">
                                <img src="${rel.image}" alt="${rel.displayName}" class="absolute top-0 left-0 w-full h-full object-contain group-hover:scale-105 transition-transform duration-300">
                                <div class="absolute bottom-2 left-2 flex items-center bg-black/70 text-white text-[0.6rem] px-2 py-1 rounded-full pointer-events-none">
                                    <img src="/path/to/your/maxben-logo.png" alt="Maxben Logo" class="w-3 h-3 mr-1"> MAXBEN
                                </div>
                            </div>
                            <div class="p-3 bg-slate-900 border-t border-slate-700 text-left flex flex-col flex-grow">
                                <p class="text-xs text-sky-400 font-semibold uppercase flex-shrink-0">${rel.category || 'S·∫£n ph·∫©m'}</p>
                                <h4 class="font-bold text-white mt-1 text-sm leading-snug flex-grow">${rel.displayName}</h4>
                                <div class="flex justify-between items-center mt-2 flex-shrink-0">
                                    <span class="text-md font-bold text-amber-400">${rel.price || 'Li√™n h·ªá'}</span>
                                    <span class="text-xs text-gray-400">${rel.power || ''} ${rel.light || ''}</span>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            </div>`; // End of modalContentArea.innerHTML backtick

        // Attach events to the newly created elements
        setupModalEventListeners(product);

        // Display the modal
        document.body.classList.add('modal-open');
        productModal.classList.remove('hidden');
        setTimeout(() => {
            modalOverlay.classList.remove('opacity-0');
            modalContainer.classList.remove('opacity-0', 'scale-95');
        }, 10);
    }

    // ==========================================================
    // === SETUP MODAL EVENT LISTENERS (Copied for this specific file) ===
    // ==========================================================
    function setupModalEventListeners(currentProduct) {
        // Thumbnail click
        const modalThumbnailGallery = document.getElementById('modalThumbnailGallery');
        if (modalThumbnailGallery) { // Ensure element exists
            modalThumbnailGallery.addEventListener('click', e => {
                if (e.target.tagName === 'IMG') {
                    document.getElementById('modalMainImage').src = e.target.src;
                    modalThumbnailGallery.querySelectorAll('.thumbnail').forEach(t => t.classList.remove('active'));
                    e.target.classList.add('active');
                }
            });
        }

        // Variant button click
        if (modalContentArea) { // Ensure modalContentArea exists
            modalContentArea.querySelectorAll('#variant-selector .variant-btn').forEach(btn => {
                if (btn.dataset.id === currentProduct.id) btn.classList.add('active'); // Highlight current variant
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    window.openProductModal(e.currentTarget.dataset.id); // Call global openProductModal
                });
            });
        }

        // Discount calculator
        const discountInput = document.getElementById('discount-percentage-input');
        const calculateBtn = document.getElementById('calculate-discount-btn');
        const discountedPriceDisplay = document.getElementById('discounted-price-display');
        if (calculateBtn) { // Check if button exists on the page
            calculateBtn.addEventListener('click', () => {
                const originalPrice = parsePrice(currentProduct.price);
                const discountPercent = parseFloat(discountInput.value);
                if (!originalPrice || isNaN(discountPercent) || discountPercent < 0 || discountPercent > 100) {
                    discountedPriceDisplay.innerHTML = `<span class="text-red-400">Vui l√≤ng nh·∫≠p % h·ª£p l·ªá.</span>`;
                } else {
                    const newPrice = originalPrice * (1 - discountPercent / 100);
                    discountedPriceDisplay.innerHTML = `Gi√° sau chi·∫øt kh·∫•u: <strong class="text-green-400 ml-2">${Math.round(newPrice).toLocaleString('vi-VN')} VNƒê</strong>`;
                }
                discountedPriceDisplay.classList.remove('hidden');
            });
        }

        // Tab switching
        if (modalContentArea) { // Ensure modalContentArea exists
            modalContentArea.querySelectorAll('#modal-tab-buttons .modal-tab-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    modalContentArea.querySelectorAll('.modal-tab-btn').forEach(b => b.classList.remove('active'));
                    e.currentTarget.classList.add('active');
                    modalContentArea.querySelector('#description-content').classList.toggle('hidden', e.currentTarget.dataset.tab !== 'description');
                    modalContentArea.querySelector('#specs-content').classList.toggle('hidden', e.currentTarget.dataset.tab !== 'specs');
                });
            });
        }

        // Related product click
        if (modalContentArea) { // Ensure modalContentArea exists
            modalContentArea.querySelectorAll('.product-showcase-card').forEach(card => {
                card.addEventListener('click', () => window.openProductModal(card.dataset.id)); // Call global openProductModal
            });
        }
    }

    function closeProductModal() {
        if (productModal) { // Check if modal element exists
            modalOverlay.classList.add('opacity-0');
            modalContainer.classList.add('opacity-0', 'scale-95');
            setTimeout(() => { productModal.classList.add('hidden'); document.body.classList.remove('modal-open'); }, 300);
        }
    }

    // --- MAIN LOGIC FOR PROJECT DETAIL PAGE ---
    function renderProjectDetail() {
        const urlParams = new URLSearchParams(window.location.search);
        const projectId = urlParams.get('id');
        const project = allProjects.find(p => p.id === projectId);

        if (project) {
            document.title = `${project.title} - MAXBEN`; // C·∫≠p nh·∫≠t ti√™u ƒë·ªÅ trang
            const relatedProjects = allProjects.filter(p => p.category === project.category && p.id !== project.id).slice(0, 3);

            const galleryThumbnailsHtml = (project.gallery || []).map((imgSrc, index) => `
                <div>
                    <img src="${imgSrc}" alt="Thumbnail ${index + 1}" class="gallery-thumbnail w-full h-24 object-cover rounded-lg cursor-pointer border-2 border-transparent hover:border-blue-400 transition-all ${index === 0 ? 'active' : ''}">
                </div>`).join('');

            const productsUsedHtml = (project.productsUsed || []).map(prod => `
                <div data-product-name="${prod.name}" class="product-used-card flex flex-col items-center text-center p-4 bg-slate-800 rounded-lg hover:bg-slate-700 transition-colors group border border-slate-700 cursor-pointer">
                    <div class="w-24 h-24 mb-4 bg-white rounded-lg flex items-center justify-center p-2 pointer-events-none">
                        <img src="${prod.img}" alt="${prod.name}" class="w-full h-full object-contain rounded-md transition-transform duration-300 group-hover:scale-110">
                    </div>
                    <span class="font-semibold text-sm text-gray-300 pointer-events-none">${prod.name}</span>
                </div>`).join('');

            const relatedProjectsHtml = relatedProjects.map(p => `
                <a href="du-an-chi-tiet.html?id=${p.id}" class="block bg-slate-800 rounded-lg overflow-hidden group border border-slate-700 hover:border-blue-500 transition-all duration-300 transform hover:-translate-y-1">
                    <div class="overflow-hidden h-48">
                        <img src="${p.img}" alt="${p.title}" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300">
                    </div>
                    <div class="p-4">
                        <p class="text-sm text-blue-400 font-semibold uppercase">${p.category}</p>
                        <h3 class="font-bold text-white mt-1 truncate">${p.title}</h3>
                    </div>
                </a>`).join('');

            projectDetailContentContainer.innerHTML = `
                <div class="max-w-6xl mx-auto px-4">
                    <div class="text-center mb-12">
                        <p class="text-sm text-blue-400 font-semibold mb-2 uppercase tracking-wider">${project.category}</p>
                        <h1 class="text-4xl md:text-5xl font-extrabold text-white">${project.title}</h1>
                    </div>
                    <div class="mb-16">
                        <div class="rounded-xl overflow-hidden mb-4 shadow-2xl bg-white">
                            <img src="${project.gallery[0]}" alt="·∫¢nh ch√≠nh d·ª± √°n ${project.title}" id="main-gallery-image" class="w-full h-auto max-h-[80vh] object-contain transition-opacity duration-300 ease-in-out">
                        </div>
                        <div id="gallery-thumbnails" class="grid grid-cols-4 md:grid-cols-6 gap-4">${galleryThumbnailsHtml}</div>
                    </div>
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-12">
                        <div class="lg:col-span-2">
                            <div class="prose-custom max-w-none text-lg leading-relaxed">
                                <h3>Th√¥ng Tin D·ª± √Ån</h3>
                                <p>${project.desc}</p>
                                <h3>Th√°ch Th·ª©c</h3>
                                <p>${project.challenge || '...'}</p>
                                <h3>Gi·∫£i Ph√°p T·ª´ MAXBEN</h3>
                                <p>${project.solution || '...'}</p>
                            </div>
                        </div>
                        <div class="lg:col-span-1">
                            <div class="bg-slate-900 border border-slate-800 rounded-xl p-6 sticky top-24">
                                <h3 class="text-xl font-bold mb-4 text-white">T·ªïng Quan</h3>
                                <ul class="space-y-3 text-sm border-b border-gray-700 pb-4 mb-4">
                                    <li class="flex justify-between"><span class="text-gray-400">Kh√°ch h√†ng:</span> <span class="font-semibold text-gray-400 text-right">${project.client || 'N/A'}</span></li>
                                    <li class="flex justify-between"><span class="text-gray-400">ƒê·ªãa ƒëi·ªÉm:</span> <span class="font-semibold text-gray-400 text-right">${project.location || 'N/A'}</span></li>
                                    <li class="flex justify-between"><span class="text-gray-400">NƒÉm:</span> <span class="font-semibold text-gray-400 text-right">${project.year || 'N/A'}</span></li>
                                </ul>
                                <div class="testimonial-card p-4 rounded-lg">
                                    <i class="fas fa-quote-left text-2xl text-blue-500 opacity-50 mb-2"></i>
                                    <p class="text-gray-300 italic mb-3 text-sm">"${project.testimonial || '...'}"</p>
                                    <p class="font-bold text-right text-white text-sm">- ${project.customerName || 'Kh√°ch h√†ng'}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-16 md:mt-24">
                        <h3 class="text-3xl font-bold text-white mb-8 text-center">S·∫£n Ph·∫©m ƒê√£ D√πng</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 max-w-4xl mx-auto">${productsUsedHtml}</div>
                    </div>
                </div>
                <section class="mt-16 md:mt-24 py-16 bg-slate-900 rounded-t-2xl">
                    <div class="container mx-auto px-6">
                        <h2 class="text-3xl font-bold text-center mb-12 text-white">C√°c D·ª± √Ån Kh√°c</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">${relatedProjectsHtml}</div>
                    </div>
                </section>
            `;

            // Attach event listeners for gallery and used products after rendering HTML
            const mainImage = document.getElementById('main-gallery-image');
            const thumbnails = document.querySelectorAll('.gallery-thumbnail');
            thumbnails.forEach(thumb => {
                thumb.addEventListener('click', function() {
                    mainImage.style.opacity = '0';
                    setTimeout(() => { mainImage.src = this.src; mainImage.style.opacity = '1'; }, 200);
                    document.querySelector('.gallery-thumbnail.active').classList.remove('active');
                    this.classList.add('active');
                });
            });

            const productCardsUsed = document.querySelectorAll('.product-used-card');
            productCardsUsed.forEach(card => {
                card.addEventListener('click', () => {
                    const productName = card.dataset.productName;
                    const productToOpen = Object.values(allProducts).find(p => p.name === productName);
                    if (productToOpen) {
                        window.openProductModal(productToOpen.id); // Call the globally exposed modal function
                    } else {
                        alert(`Kh√¥ng t√¨m th·∫•y th√¥ng tin cho s·∫£n ph·∫©m: "${productName}".\nVui l√≤ng ki·ªÉm tra l·∫°i t√™n trong project-data.js.`);
                    }
                });
            });

        } else {
            projectDetailContentContainer.innerHTML = `
                <div class="container mx-auto px-6 text-center py-20">
                    <h1 class="text-3xl text-red-500 font-bold">Kh√¥ng T√¨m Th·∫•y D·ª± √Ån</h1>
                    <p class="text-gray-400 mt-4">D·ª± √°n b·∫°n ƒëang t√¨m ki·∫øm kh√¥ng t·ªìn t·∫°i ho·∫∑c ƒë√£ b·ªã x√≥a. Vui l√≤ng ki·ªÉm tra l·∫°i ID tr√™n ƒë∆∞·ªùng d·∫´n.</p>
                    <a href="du-an.html" class="mt-8 inline-block bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg hover:bg-blue-700">Quay l·∫°i danh s√°ch</a>
                </div>
            `;
        }
    }

    // --- GLOBAL MODAL CLOSE LISTENERS ---
    // These listeners are outside openProductModal/setupModalEventListeners
    // so they are attached only once when the page loads.
    if (modalCloseBtn) modalCloseBtn.addEventListener('click', closeProductModal);
    if (modalOverlay) modalOverlay.addEventListener('click', closeProductModal);
    document.addEventListener('keydown', (e) => {
        if (e.key === "Escape" && productModal && !productModal.classList.contains('hidden')) {
            closeProductModal();
        }
    });

    function closeProductModal() {
        if (productModal) {
            modalOverlay.classList.add('opacity-0');
            modalContainer.classList.add('opacity-0', 'scale-95');
            setTimeout(() => {
                productModal.classList.add('hidden');
                document.body.classList.remove('modal-open');
            }, 300);
        }
    }

    // --- INITIALIZATION ---
    // This will run when the DOM is ready on du-an-chi-tiet.html
    if (projectDetailContentContainer) {
        renderProjectDetail();
    }
});
</script>

 <script src="project-data.js"></script>
    <script src="product-details.js"></script>
        <script src="main-layout.js"></script> 

</body>
</html>
